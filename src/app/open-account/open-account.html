<div class="page">

  <!-- HEADER -->
  <header class="header">
    <div class="logo">
      <span class="logo-icon">ğŸ¦</span>
      <span class="logo-text">Mini Bank</span>
    </div>

    <nav class="nav">
      <button routerLink="/dashboard" class="btn outline">Dashboard</button>
      <button routerLink="/" class="btn outline">Logout</button>
    </nav>
  </header>

  <!-- FORM -->
  <div class="form-container">
    <div class="card">
      <h2>Open Bank Account</h2>
      <p class="subtitle">Fill your details to create an account</p>

      <form #accountForm="ngForm" (ngSubmit)="submit()" novalidate>

        <!-- FULL NAME -->
        <input type="text"
               placeholder="Full Name"
               name="fullName"
               [(ngModel)]="fullName"
               #fullNameRef="ngModel"
               required
               minlength="3" />

        <small class="error"
          *ngIf="fullNameRef.invalid && (fullNameRef.dirty || accountForm.submitted)">
          Full name must be at least 3 characters
        </small>

        <!-- DATE OF BIRTH -->
        <input type="date"
               name="dob"
               [(ngModel)]="dob"
               #dobRef="ngModel"
               required
               [max]="maxDob"
               [min]="minDob"
               (change)="validateDob()" />

        <small class="error" *ngIf="dobError">
          Age must be between 18 and 100 years
        </small>

        <!-- PHONE NUMBER -->
        <input type="text"
               placeholder="Phone Number"
               name="phoneNumber"
               maxlength="10"
               [(ngModel)]="phoneNumber"
               #phoneRef="ngModel"
               required
               pattern="^[6-9][0-9]{9}$" />

        <small class="error"
          *ngIf="phoneRef.invalid && (phoneRef.dirty || accountForm.submitted)">
          Enter a valid 10-digit phone number
        </small>

        <!-- IDENTITY TYPE -->
        <select name="identityType"
                [(ngModel)]="identityType"
                required>
          <option value="AADHAAR">Aadhaar</option>
          <option value="PASSPORT">Passport</option>
        </select>

        <!-- IDENTITY NUMBER -->
        <input type="text"
               placeholder="Identity Number"
               name="identityNumber"
               [(ngModel)]="identityNumber"
               #identityRef="ngModel"
               required
               [maxlength]="identityType === 'AADHAAR' ? 12 : 20"
               [pattern]="identityType === 'AADHAAR' ? '^[0-9]{12}$' : '.*'" />

        <small class="error"
          *ngIf="identityRef.invalid && identityType === 'AADHAAR'
                 && (identityRef.dirty || accountForm.submitted)">
          Aadhaar number must be exactly 12 digits
        </small>

        <!-- ACCOUNT TYPE -->
        <select name="accountType"
                [(ngModel)]="accountType"
                #typeRef="ngModel"
                required>
          <option value="">Select Account Type</option>
          <option value="SAVINGS">Savings Account</option>
          <option value="CURRENT">Current Account</option>
        </select>

        <small class="error"
          *ngIf="typeRef.invalid && (typeRef.dirty || accountForm.submitted)">
          Please select account type
        </small>

        <!-- BACKEND MESSAGES -->
        <p class="success" *ngIf="successMessage">{{ successMessage }}</p>
        <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>

        <!-- SUBMIT -->
        <button type="submit"
                class="btn primary full"
                [disabled]="accountForm.invalid || dobError || isSubmitting">
          {{ isSubmitting ? 'Processing...' : 'Create Account' }}
        </button>

      </form>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    Â© 2026 Mini Bank. All rights reserved.
  </footer>

</div>
